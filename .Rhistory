caption="註解可放這大小20px", #若沒註解的話這行就拿掉
x=NULL,
y=NULL)+
my_theme+
scale_y_continuous(expand = expansion(mult = c(0, .1)))
my_theme<-theme(
text=element_text(family="source-han-sans-tw"),
plot.margin = margin(2, 2, 2, 2,"cm"),
legend.position = "none",
plot.title= element_text(hjust=0.5,vjust=4,face="bold",size=32),
plot.caption = element_text(hjust=1,vjust=-3.5,face="bold",size=20),
panel.grid.major = element_blank(),
panel.background = element_blank(),
axis.text = element_text(size=16),
axis.text.x = element_text(margin=margin(t=15)),
axis.text.y = element_text(margin=margin(r=15)),
axis.ticks = element_blank(),
aspect.ratio = 1.5/2.5,
panel.border = element_rect(colour = "black", fill=NA, size=1),
)
g3<-g3+labs(title="標題放這大小32px",
caption="註解可放這大小20px", #若沒註解的話這行就拿掉
x=NULL,
y=NULL)+
my_theme+
scale_y_continuous(expand = expansion(mult = c(0, .1)))
my_theme<-theme(
text=element_text(family="source-han-sans-tw"),
plot.margin = margin(2, 2, 2, 2,"cm"),
legend.position = "none",
plot.title= element_text(hjust=0.5,vjust=4,face="bold",size=32),
plot.caption = element_text(hjust=1,vjust=-3.5,face="bold",size=20),
panel.grid.major = element_blank(),
panel.background = element_blank(),
axis.text = element_text(size=16),
axis.text.x = element_text(margin=margin(t=15)),
axis.text.y = element_text(margin=margin(r=15)),
axis.ticks = element_blank(),
aspect.ratio = 1.5/2.5,
panel.border = element_rect(colour = "black", fill=NA, size=1),
)
g3<-g3+labs(title="標題放這大小32px",
caption="註解可放這大小20px", #若沒註解的話這行就拿掉
x=NULL,
y=NULL)+
my_theme
g3
my_theme<-theme(
text=element_text(family="source-han-sans-tw"),
plot.margin = margin(2, 2, 2, 2,"cm"),
legend.position = "none",
plot.title= element_text(hjust=0.5,vjust=4,face="bold",size=32),
plot.caption = element_text(hjust=1,vjust=-3.5,face="bold",size=20),
panel.grid.major = element_blank(),
panel.background = element_blank(),
axis.text = element_text(size=16),
axis.text.x = element_text(margin=margin(t=15)),
axis.text.y = element_text(margin=margin(r=15)),
axis.ticks = element_blank(),
aspect.ratio = 1.5/2.5,
panel.border = element_rect(colour = "black", fill=NA, size=1),
)
g3<-g3+labs(title="標題放這大小32px",
caption="註解可放這大小20px", #若沒註解的話這行就拿掉
x=NULL,
y=NULL)+
my_theme
g3
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(tidyverse)
library(readr)
library(stringr)
url<-"https://raw.githubusercontent.com/Xuans1211/108coursenews/main/data/questionaire.csv"
q_raw<-read_csv(url)
#rename
names(q_raw) <- c("spend_time","n_learning","n_performance","app","app_other","freq_teacher","freq_student","freq_parent","freq_cram","help_teacher","help_student","help_parent","help_cram","heard_agency","use_agency","agg_overral","agg_feature","agg_quality","agg_outoftest","agg_future","agg_description","edge_course","edge_act","edge_future","edge_art","edge_outoftest","annoy_overral","annoy_time","annoy_orientation","annoy_lackoftime","annoy_docsize","annoy_description","attitude_before","attitude_now","attitude_description","focus_self","focus_professor","course_n","course_type","act_type","act","act_source","act_source_other","willingness","willingness_other","school","school_type","grade","grade_other","gender","cram_school","cram_spend","cram_subject","email","55","56","57","58","59","60","61","62","63")
#這段是改欄位名
clean_df <-q_raw %>%
select(spend_time:cram_subject)%>%
filter(!str_detect(school,"大學"))%>%
mutate(id=row_number())%>%
relocate(id)%>%
mutate(app=if_else(app=="其他",app_other,app),
act_source=if_else(act_source=="其他",act_source_other,act_source),
willingness=if_else(willingness=="其他",willingness_other,willingness)
)%>%
select(-c(app_other,act_source_other,willingness_other,grade_other))
knitr::opts_chunk$set(echo = TRUE)
d3<-clean_df %>%
mutate(annoyed_group=if_else(annoy_overral=="很多困擾"|annoy_overral=="有點困擾","困擾者","不困擾者"),
attitude_group=if_else(attitude_now=="非常排斥"|attitude_now=="排斥","排斥者",if_else(attitude_now=="中立","中立者","支持者")))%>%
select(annoyed_group,attitude_group,course_n:cram_subject)%>%
mutate(course_n=str_sub(course_n,1,1)%>%as.numeric())%>%
group_by(attitude_group)%>%
summarise(avg_cn=mean(course_n))%>%
ungroup()%>%
ggplot()+aes(x=attitude_group,y=avg_cn,fill=attitude_group)+geom_col()+
ylim(c(0,4))
d3
act_df<-clean_df %>%
select(id,act_type,grade)%>%
filter(!str_detect(act_type,"無參與"))%>%
mutate(技藝補習=str_detect(act_type,"技藝補習"),
考證照=str_detect(act_type,"考證照"),
參加社團=str_detect(act_type,"參加社團"),
參加競賽=str_detect(act_type,"參加競賽"),
`參加營隊、校外工作坊`=str_detect(act_type,"參加營隊、校外工作坊"),其他=str_detect(act_type,"其他"))%>%
gather(act_type,n,技藝補習,考證照,參加競賽,參加社團,`參加營隊、校外工作坊`,其他)
g1<-act_df%>%
filter(grade=="一年級")%>%
group_by(act_type)%>%
summarise(total_n=sum(n))%>%
mutate(per_n=total_n/sum(total_n))%>%
ggplot()+aes(x=reorder(act_type,-per_n),y=per_n,fill=act_type)+
geom_col(position=position_dodge())+
labs(title="參與課外活動情況（高一）：",caption="資料來源",x=NULL,y="參與比例")+
labs(x=NULL,y="參與比例")+my_theme
g2<-act_df%>%
filter(grade=="二年級")%>%
group_by(act_type)%>%
summarise(total_n=sum(n))%>%
mutate(per_n=total_n/sum(total_n))%>%
ggplot()+aes(x=reorder(act_type,-per_n),y=per_n,fill=act_type)+
geom_col(position=position_dodge())+
labs(title="參與課外活動情況（高二）：",caption="資料來源",x=NULL,y="參與比例")+
labs(x=NULL,y="參與比例")+my_theme
library(showtext)
showtext_auto()
font_families() #可以看你電腦現在有哪些字體(名稱)可以用
my_theme<-theme(
text=element_text(family="source-han-sans-tw"),
plot.margin = margin(2, 2, 2, 2,"cm"),
legend.position = "none",
plot.title= element_text(hjust=0.5,vjust=4,face="bold",size=32),
plot.caption = element_text(hjust=1,vjust=-4.5,face="bold",size=18),
panel.grid.major = element_blank(),
panel.background = element_blank(),
axis.text = element_text(size=16),
axis.text.x = element_text(margin=margin(t=15)),
axis.text.y = element_text(margin=margin(r=15)),
axis.ticks = element_blank(),
axis.line.x = element_line(colour = "black",size=2),
plot.background = element_rect(colour = "black", fill=NA, size=3)
)
library(ggpubr)
act_df<-clean_df %>%
select(id,act_type,grade)%>%
filter(!str_detect(act_type,"無參與"))%>%
mutate(技藝補習=str_detect(act_type,"技藝補習"),
考證照=str_detect(act_type,"考證照"),
參加社團=str_detect(act_type,"參加社團"),
參加競賽=str_detect(act_type,"參加競賽"),
`參加營隊、校外工作坊`=str_detect(act_type,"參加營隊、校外工作坊"),其他=str_detect(act_type,"其他"))%>%
gather(act_type,n,技藝補習,考證照,參加競賽,參加社團,`參加營隊、校外工作坊`,其他)
g1<-act_df%>%
filter(grade=="一年級")%>%
group_by(act_type)%>%
summarise(total_n=sum(n))%>%
mutate(per_n=total_n/sum(total_n))%>%
ggplot()+aes(x=reorder(act_type,-per_n),y=per_n,fill=act_type)+
geom_col(position=position_dodge())+
labs(title="參與課外活動情況（高一）：",caption="資料來源",x=NULL,y="參與比例")+
labs(x=NULL,y="參與比例")+my_theme
g2<-act_df%>%
filter(grade=="二年級")%>%
group_by(act_type)%>%
summarise(total_n=sum(n))%>%
mutate(per_n=total_n/sum(total_n))%>%
ggplot()+aes(x=reorder(act_type,-per_n),y=per_n,fill=act_type)+
geom_col(position=position_dodge())+
labs(title="參與課外活動情況（高二）：",caption="資料來源",x=NULL,y="參與比例")+
labs(x=NULL,y="參與比例")+my_theme
g3<-act_df%>%
filter(grade=="三年級")%>%
group_by(act_type)%>%
summarise(total_n=sum(n))%>%
mutate(per_n=total_n/sum(total_n))%>%
ggplot()+aes(x=reorder(act_type,-per_n),y=per_n,fill=act_type)+
geom_col(position=position_dodge())
g3
g1<-act_df%>%
filter(grade=="一年級")%>%
group_by(act_type)%>%
summarise(total_n=sum(n))%>%
mutate(per_n=total_n/sum(total_n))%>%
ggplot()+aes(x=reorder(act_type,-per_n),y=per_n,fill=act_type)+
geom_col(position=position_dodge())+
labs(title="參與課外活動情況（高一）：",caption="資料來源",x=NULL,y="參與比例")+
labs(x=NULL,y="參與比例")+my_theme
g1
g1<-act_df%>%
filter(grade=="一年級")%>%
group_by(act_type)%>%
summarise(total_n=sum(n))%>%
mutate(per_n=total_n/sum(total_n))%>%
ggplot()+aes(x=reorder(act_type,-per_n),y=per_n,fill=act_type)+
geom_col(position=position_dodge())+
labs(title="參與課外活動情況（高一）：",caption="資料來源",x=NULL,y="參與比例")+
my_theme+
scale_y_continuous(expand = expansion(mult = c(0, 0.05)))+
labs(title="標題放這大小32px",
caption="註解可放這大小18px", #若沒註解的話這行就拿掉
x=NULL,
y=NULL)
plot
g1
g1<-act_df%>%
filter(grade=="一年級")%>%
group_by(act_type)%>%
summarise(total_n=sum(n))%>%
mutate(per_n=total_n/sum(total_n))%>% view
ggplot()+aes(x=reorder(act_type,-per_n),y=per_n,fill=act_type)+
geom_col(position=position_dodge())+
labs(title="參與課外活動情況（高一）：",caption="資料來源",x=NULL,y="參與比例")+
my_theme+
scale_y_continuous(expand = expansion(mult = c(0, 0.05)))+
labs(title="標題放這大小32px",
caption="註解可放這大小18px", #若沒註解的話這行就拿掉
x=NULL,
y=NULL)
g1
g1<-act_df%>%
filter(grade=="一年級")%>%
group_by(act_type)%>%
summarise(total_n=sum(n))%>%
mutate(per_n=total_n/sum(total_n))%>%
ggplot()+aes(x=reorder(act_type,-per_n),y=per_n,fill=act_type)+
geom_col(position=position_dodge())+
my_theme+
scale_y_continuous(expand = expansion(mult = c(0, 0.05)))+
labs(title="高一",
caption="本題題項調查學生為了製作學習歷程檔案而額外多做的課外活動", #若沒註解的話這行就拿掉
x=參與,
y=NULL)
g1<-act_df%>%
filter(grade=="一年級")%>%
group_by(act_type)%>%
summarise(total_n=sum(n))%>%
mutate(per_n=total_n/sum(total_n))%>%
ggplot()+aes(x=reorder(act_type,-per_n),y=per_n,fill=act_type)+
geom_col(position=position_dodge())+
my_theme+
scale_y_continuous(expand = expansion(mult = c(0, 0.05)))+
labs(title="額外參與的課外活動類型(高一)",
x=NULL,
y="參與比例(%)")
g1
g1<-act_df%>%
filter(grade=="一年級")%>%
group_by(act_type)%>%
summarise(total_n=sum(n))%>%
mutate(per_n=total_n/sum(total_n))%>%
ggplot()+aes(x=reorder(act_type,-per_n),y=per_n,fill=act_type)+
geom_col(position=position_dodge())+
my_theme+
scale_y_continuous(expand = expansion(mult = c(0, 0.05)))+
scale_fill_manual(values="#023047")
labs(title="高一生額外參與的課外活動類型",
x=NULL,
y="參與比例(%)")
g1<-act_df%>%
filter(grade=="一年級")%>%
group_by(act_type)%>%
summarise(total_n=sum(n))%>%
mutate(per_n=total_n/sum(total_n))%>%
ggplot()+aes(x=reorder(act_type,-per_n),y=per_n,fill=act_type)+
geom_col(position=position_dodge())+
my_theme+
scale_y_continuous(expand = expansion(mult = c(0, 0.05)))+
scale_fill_manual(values="#023047")+
labs(title="高一生額外參與的課外活動類型",
x=NULL,
y="參與比例(%)")
g1
g1<-act_df%>%
filter(grade=="一年級")%>%
group_by(act_type)%>%
summarise(total_n=sum(n))%>%
mutate(per_n=total_n/sum(total_n))%>%
ggplot()+aes(x=reorder(act_type,-per_n),y=per_n,fill="#023047")+
geom_col(position=position_dodge())+
my_theme+
scale_y_continuous(expand = expansion(mult = c(0, 0.05)))+
labs(title="高一生額外參與的課外活動類型",
x=NULL,
y="參與比例(%)")
g1
png("chart/g1.png", #請自己打檔案名稱，"chart/"這段不要改
width=1280,height=900,units="px") #大小及單位，這裡有需要再調
g1 #要輸出的那個圖，原本在你Rstudio裡叫什麼
dev.off()
dev、.off()
dev.off()
g1
g1<-act_df%>%
filter(grade=="一年級")%>%
group_by(act_type)%>%
summarise(total_n=sum(n))%>%
mutate(per_n=total_n/sum(total_n))%>%
ggplot()+aes(x=reorder(act_type,-per_n),y=per_n,fill="023047")+
geom_col(position=position_dodge())+
my_theme+
scale_y_continuous(expand = expansion(mult = c(0, 0.05)))+
labs(title="高一生額外參與的課外活動類型",
x=NULL,
y="參與比例(%)")
g1
png("chart/g1.png", #請自己打檔案名稱，"chart/"這段不要改
width=1280,height=900,units="px") #大小及單位，這裡有需要再調
g1 #要輸出的那個圖，原本在你Rstudio裡叫什麼
dev.off()
g1
g1<-act_df%>%
filter(grade=="一年級")%>%
group_by(act_type)%>%
summarise(total_n=sum(n))%>%
mutate(per_n=total_n/sum(total_n))%>%
ggplot()+aes(x=reorder(act_type,-per_n),y=per_n)+
geom_col(position=position_dodge())+
my_theme+
scale_y_continuous(expand = expansion(mult = c(0, 0.05)))+
scale_fill_manual(values="#023047")+
labs(title="高一生額外參與的課外活動類型",
x=NULL,
y="參與比例(%)")
g1
g1<-act_df%>%
filter(grade=="一年級")%>%
group_by(act_type)%>%
summarise(total_n=sum(n))%>%
mutate(per_n=total_n/sum(total_n))%>%
ggplot()+aes(x=reorder(act_type,-per_n),y=per_n)+
geom_col(position=position_dodge())+
my_theme+
scale_y_continuous(expand = expansion(mult = c(0, 0.05)))+
scale_fill_manual(values="#219EBC")+
labs(title="高一生額外參與的課外活動類型",
x=NULL,
y="參與比例(%)")
g1
g1<-act_df%>%
filter(grade=="一年級")%>%
group_by(act_type)%>%
summarise(total_n=sum(n))%>%
mutate(per_n=total_n/sum(total_n))%>%
ggplot()+aes(x=reorder(act_type,-per_n),y=per_n)+
geom_col(position=position_dodge())+
my_theme+
scale_y_continuous(expand = expansion(mult = c(0, 0.05)))+
scale_fill_manual(values=c("#219EBC","#219EBC","#219EBC","#219EBC","#219EBC","#219EBC"))+
labs(title="高一生額外參與的課外活動類型",
x=NULL,
y="參與比例(%)")
g1
g1<-act_df%>%
filter(grade=="一年級")%>%
group_by(act_type)%>%
summarise(total_n=sum(n))%>%
mutate(per_n=total_n/sum(total_n))%>%
ggplot()+aes(x=reorder(act_type,-per_n),y=per_n,fill=act_type)+
geom_col(position=position_dodge())+
my_theme+
scale_y_continuous(expand = expansion(mult = c(0, 0.05)))+
scale_fill_manual(values=c("#219EBC","#219EBC","#219EBC","#219EBC","#219EBC","#219EBC"))+
labs(title="高一生額外參與的課外活動類型",
x=NULL,
y="參與比例(%)")
g1
g1<-act_df%>%
filter(grade=="一年級")%>%
group_by(act_type)%>%
summarise(total_n=sum(n))%>%
mutate(per_n=total_n/sum(total_n))%>%
ggplot()+aes(x=reorder(act_type,-per_n),y=per_n,fill=act_type)+
geom_col(position=position_dodge())+
my_theme+
scale_y_continuous(expand = expansion(mult = c(0, 0.05)))+
scale_fill_manual(values=c("#023047","#023047","#023047","#023047","#023047","#023047"))+
labs(title="高一生額外參與的課外活動類型",
x=NULL,
y="參與比例(%)")
g1
png("chart/g1.png", #請自己打檔案名稱，"chart/"這段不要改
width=1280,height=900,units="px") #大小及單位，這裡有需要再調
g1 #要輸出的那個圖，原本在你Rstudio裡叫什麼
dev.off()
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(tidyverse)
library(readr)
library(stringr)
url<-"https://raw.githubusercontent.com/Xuans1211/108coursenews/main/data/questionaire.csv"
q_raw<-read_csv(url)
q_raw<-read_csv(url)
#rename
names(q_raw) <- c("spend_time","n_learning","n_performance","app","app_other","freq_teacher","freq_student","freq_parent","freq_cram","help_teacher","help_student","help_parent","help_cram","heard_agency","use_agency","agg_overral","agg_feature","agg_quality","agg_outoftest","agg_future","agg_description","edge_course","edge_act","edge_future","edge_art","edge_outoftest","annoy_overral","annoy_time","annoy_orientation","annoy_lackoftime","annoy_docsize","annoy_description","attitude_before","attitude_now","attitude_description","focus_self","focus_professor","course_n","course_type","act_type","act","act_source","act_source_other","willingness","willingness_other","school","school_type","grade","grade_other","gender","cram_school","cram_spend","cram_subject","email","55","56","57","58","59","60","61","62","63")
#這段是改欄位名
clean_df <-q_raw %>%
select(spend_time:cram_subject)%>%
filter(!str_detect(school,"大學"))%>%
mutate(id=row_number())%>%
relocate(id)%>%
mutate(app=if_else(app=="其他",app_other,app),
act_source=if_else(act_source=="其他",act_source_other,act_source),
willingness=if_else(willingness=="其他",willingness_other,willingness)
)%>%
select(-c(app_other,act_source_other,willingness_other,grade_other))
library(showtext)
showtext_auto()
#下載台北黑體
#font_install(source_han_sans(lang = "TW"))
showtext_auto()
font_families() #可以看你電腦現在有哪些字體(名稱)可以用
my_theme<-theme(
text=element_text(family="source-han-sans-tw"),
plot.margin = margin(2, 2, 2, 2,"cm"),
legend.position = "none",
plot.title= element_text(hjust=0.5,vjust=4,face="bold",size=32),
plot.caption = element_text(hjust=1,vjust=-4.5,face="bold",size=18),
panel.grid.major = element_blank(),
panel.background = element_blank(),
axis.text = element_text(size=16),
axis.text.x = element_text(margin=margin(t=15)),
axis.text.y = element_text(margin=margin(r=15)),
axis.ticks = element_blank(),
axis.line.x = element_line(colour = "black",size=2),
plot.background = element_rect(colour = "black", fill=NA, size=3)
)
act_df<-clean_df %>%
select(id,act_type,grade)%>%
filter(!str_detect(act_type,"無參與"))%>%
mutate(技藝補習=str_detect(act_type,"技藝補習"),
考證照=str_detect(act_type,"考證照"),
參加社團=str_detect(act_type,"參加社團"),
參加競賽=str_detect(act_type,"參加競賽"),
`參加營隊、校外工作坊`=str_detect(act_type,"參加營隊、校外工作坊"),其他=str_detect(act_type,"其他"))%>%
gather(act_type,n,技藝補習,考證照,參加競賽,參加社團,`參加營隊、校外工作坊`,其他)
g1<-act_df%>%
filter(grade=="一年級")%>%
group_by(act_type)%>%
summarise(total_n=sum(n))%>%
mutate(per_n=total_n/sum(total_n))%>%
ggplot()+aes(x=reorder(act_type,-per_n),y=per_n,fill=act_type)+
geom_col(position=position_dodge())+
my_theme+
scale_y_continuous(expand = expansion(mult = c(0, 0.05)))+
scale_fill_manual(values=c("#023047","#023047","#023047","#023047","#023047","#023047"))+
labs(title="高一生額外參與的課外活動類型",
x=NULL,
y="參與比例(%)")
g1
png("chart/g1.png", #請自己打檔案名稱，"chart/"這段不要改
width=1280,height=900,units="px") #大小及單位，這裡有需要再調
g1 #要輸出的那個圖，原本在你Rstudio裡叫什麼
dev.off()
while (!is.null(dev.list()))  dev.off()
dev.off()
while (!is.null(dev.list()))  dev.off()
while (!is.null(dev.list()))
dev.off()
png("chart/g1.png", #請自己打檔案名稱，"chart/"這段不要改
width=1280,height=900,units="px") #大小及單位，這裡有需要再調
g1 #要輸出的那個圖，原本在你Rstudio裡叫什麼
dev.off()
dev.set(dev.next())
g1
png("chart/g1.png", #請自己打檔案名稱，"chart/"這段不要改
width=1280,height=900,units="px") #大小及單位，這裡有需要再調
g1 #要輸出的那個圖，原本在你Rstudio裡叫什麼
dev.set(dev.next())
g1
png("chart/g1.png", #請自己打檔案名稱，"chart/"這段不要改
width=1280,height=900,units="px") #大小及單位，這裡有需要再調
g1 #要輸出的那個圖，原本在你Rstudio裡叫什麼
dev.off()
g1<-act_df%>%
filter(grade=="一年級")%>%
group_by(act_type)%>%
summarise(total_n=sum(n))%>%
mutate(per_n=total_n/sum(total_n))%>%
ggplot()+aes(x=reorder(act_type,-per_n),y=per_n,fill=act_type)+
geom_col(position=position_dodge())+
my_theme+
scale_y_continuous(expand = expansion(mult = c(0, 0.05)))+
scale_fill_manual(values=c("#023047","#023047","#023047","#023047","#023047","#023047"))+
labs(title="高一生額外參與的課外活動類型",
x=NULL,
y="參與比例(%)")
g1
png("chart/g1.png", #請自己打檔案名稱，"chart/"這段不要改
width=1280,height=900,units="px") #大小及單位，這裡有需要再調
g1 #要輸出的那個圖，原本在你Rstudio裡叫什麼
while (!is.null(dev.list()))  dev.off()
g1<-act_df%>%
filter(grade=="一年級")%>%
group_by(act_type)%>%
summarise(total_n=sum(n))%>%
mutate(per_n=total_n/sum(total_n))%>%
ggplot()+aes(x=reorder(act_type,-per_n),y=per_n,fill=act_type)+
geom_col(position=position_dodge())+
my_theme+
scale_y_continuous(expand = expansion(mult = c(0, 0.05)))+
scale_fill_manual(values=c("#023047","#023047","#023047","#023047","#023047","#023047"))+
labs(title="高一生額外參與的課外活動類型",
x=NULL,
y="參與比例(%)")
g1
png("chart/g1.png", #請自己打檔案名稱，"chart/"這段不要改
width=1280,height=900,units="px") #大小及單位，這裡有需要再調
g1 #要輸出的那個圖，原本在你Rstudio裡叫什麼
while (!is.null(dev.list()))  dev.off()
