knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(readr)
url<-"https://github.com/Xuans1211/108coursenews/blob/main/data/questionaire.csv"
q_raw<-read_csv(url)
View(q_raw)
q_raw<-read_csv(url)
View(q_raw)
?read_csv
library(showtext)
library(tidyverse)
.libPaths("C:\Program Files\R\R-4.1.3")
.libPaths("C:\\Program Files\\R\\R-4.1.3")
library(showtext)
library(showtext)
library(tidyverse)
library(showtext)
library(tidyverse)
P0<-df_2019 %>%
ggplot(aes(x=income,y=perc,fill=income))+
geom_bar(stat = "identity",width = 0.7)+
geom_text(aes(label=percentage),hjust=1.2,size=5)+
coord_flip()+
labs(title="標題放這裡",
caption= "資料來源放這裡",x=NULL,y=NULL)+
theme(
legend.position = "none",
plot.title= element_text(hjust=0.5,face="bold"),
plot.caption = element_text(hjust=0.5,face="bold"),
panel.grid.major = element_blank(),
panel.background = element_blank(),
axis.text.y = element_text(hjust = 1.4,margin=margin(r=0,l=0),size=10),
axis.title.y = element_text(angle=0),
axis.ticks = element_blank(),
axis.text.x = element_blank(),
aspect.ratio = 1.5/2.5,
panel.border = element_rect(colour = "black", fill=NA, size=1)
)+scale_fill_manual(values=c("#E0E0E0","#E0E0E0","#E0E0E0","#E0E0E0","#E0E0E0","#FFE66F"))
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(readr)
library(stringr)
url<-"https://raw.githubusercontent.com/Xuans1211/108coursenews/main/data/questionaire.csv"
url<-"https://raw.githubusercontent.com/Xuans1211/108coursenews/main/data/questionaire.csv"
q_raw<-read_csv(url)
#rename
colnames<-read.csv("colnames.csv")
colnames(q_raw)<-colnames$name
clean_df <-q_raw %>%
select(spend_time:cram_subject)%>%
filter(!str_detect(school,"大學"))%>%
mutate(id=row_number())%>%
relocate(id)%>%
mutate(app=if_else(app=="其他",app_other,app),
act_source=if_else(act_source=="其他",act_source_other,act_source),
willingness=if_else(willingness=="其他",willingness_other,willingness)
)%>%
select(-c(app_other,act_source_other,willingness_other,grade_other))
act_df<-clean_df %>%
select(id,act_type,grade)%>%
filter(!str_detect(act_type,"無參與"))%>%
mutate(技藝補習=str_detect(act_type,"技藝補習"),
考證照=str_detect(act_type,"考證照"),
參加社團=str_detect(act_type,"參加社團"),
參加競賽=str_detect(act_type,"參加競賽"),
`參加營隊、校外工作坊`=str_detect(act_type,"參加營隊、校外工作坊"),其他=str_detect(act_type,"其他"))%>%
gather(act_type,n,技藝補習,考證照,參加競賽,參加社團,`參加營隊、校外工作坊`,其他)%>%
group_by(grade,act_type)%>%
summarise(total_n=sum(n))%>%
ggplot()+aes(x=reorder(act_type,-total_n),y=total_n,fill=grade)+
geom_col(position=position_dodge())
act_df
clean_df %>%
select(id,act_type,cram_school,cram_spend)%>%
mutate(act_n=str_count(act_type,pattern="\n")+1)%>%
mutate(考證照=str_detect(act_type,"考證照"),
參加社團=str_detect(act_type,"參加社團"),
參加競賽=str_detect(act_type,"參加競賽"),
`參加營隊、校外工作坊`=str_detect(act_type,"參加營隊、校外工作坊"),其他=str_detect(act_type,"其他"))%>%
gather(act_type,n,考證照,參加競賽,參加社團,`參加營隊、校外工作坊`,其他)%>% view
p1<-colnames$name
saveRDs(p1,"p2")
saveRDs(p1,"p2.rds")
saveRDs(p1,"p2.RDS")
saveRDS(p1,"p2.RDS")
url<-"https://raw.githubusercontent.com/Xuans1211/108coursenews/main/data/questionaire.csv"
q_raw<-read_csv(url)
p2 <- readRDS("D:/desktop/Graduate School/110-2/data_R/108coursenews/p2.RDS")
colnames(q_raw)<-p2
View(q_raw)
View(q_raw)
clean_df <-q_raw %>%
select(spend_time:cram_subject)%>%
filter(!str_detect(school,"大學"))%>%
mutate(id=row_number())%>%
relocate(id)%>%
mutate(app=if_else(app=="其他",app_other,app),
act_source=if_else(act_source=="其他",act_source_other,act_source),
willingness=if_else(willingness=="其他",willingness_other,willingness)
)%>%
select(-c(app_other,act_source_other,willingness_other,grade_other))
View(q_raw)
act_df<-clean_df %>%
select(id,act_type,grade)%>%
filter(!str_detect(act_type,"無參與"))%>%
mutate(技藝補習=str_detect(act_type,"技藝補習"),
考證照=str_detect(act_type,"考證照"),
參加社團=str_detect(act_type,"參加社團"),
參加競賽=str_detect(act_type,"參加競賽"),
`參加營隊、校外工作坊`=str_detect(act_type,"參加營隊、校外工作坊"),其他=str_detect(act_type,"其他"))%>%
gather(act_type,n,技藝補習,考證照,參加競賽,參加社團,`參加營隊、校外工作坊`,其他)%>%
group_by(grade,act_type)%>%
summarise(total_n=sum(n))%>%
ggplot()+aes(x=reorder(act_type,-total_n),y=total_n,fill=grade)+
geom_col(position=position_dodge())
act_df
clean_df %>%
select(id,act_type,cram_school,cram_spend)%>%
mutate(act_n=str_count(act_type,pattern="\n")+1)%>%
mutate(考證照=str_detect(act_type,"考證照"),
參加社團=str_detect(act_type,"參加社團"),
參加競賽=str_detect(act_type,"參加競賽"),
`參加營隊、校外工作坊`=str_detect(act_type,"參加營隊、校外工作坊"),其他=str_detect(act_type,"其他"))%>%
gather(act_type,n,考證照,參加競賽,參加社團,`參加營隊、校外工作坊`,其他)%>% view
clean_df %>%
count(annoy_overral)%>% view
clean_df%>%
count(attitude_now)%>%view
clean_df%>%
group_by(grade)
clean_df%>%
group_by(grade)%>%
count(attitude_now)%>%view
clean_df%>%
count(attitude_now)%>%
clean_df <-q_raw %>%
select(spend_time:cram_subject)%>%
filter(!str_detect(school,"大學"))%>%
mutate(id=row_number())%>%
relocate(id)%>%
mutate(app=if_else(app=="其他",app_other,app),
act_source=if_else(act_source=="其他",act_source_other,act_source),
willingness=if_else(willingness=="其他",willingness_other,willingness)
)%>%
select(-c(app_other,act_source_other,willingness_other,grade_other))
clean_df%>%
count(attitude_now)
clean_df%>%
count(attitude_now)%>% view
knitr::opts_chunk$set(echo = TRUE)
url<-"https://raw.githubusercontent.com/Xuans1211/108coursenews/main/data/questionaire.csv"
q_raw<-read_csv(url)
library(tidyverse)
library(tidyverse)
library(readr)
library(stringr)
q_raw<-read_csv(url)
#rename
names(q_raw) <- c("spend_time","n_learning","n_performance","app","app_other","freq_teacher","freq_student","freq_parent","freq_cram","help_teacher","help_student","help_parent","help_cram","heard_agency","use_agency","agg_overral","agg_feature","agg_quality","agg_outoftest","agg_future","agg_description","edge_course","edge_act","edge_future","edge_art","edge_outoftest","annoy_overral","annoy_time","annoy_orientation","annoy_lackoftime","annoy_docsize","annoy_description","attitude_before","attitude_now","attitude_description","focus_self","focus_professor","course_n","course_type","act_type","act","act_source","act_source_other","willingness","willingness_other","school","school_type","grade","grade_other","gender","cram_school","cram_spend","cram_subject","email","55","56","57","58","59","60","61","62","63")
clean_df <-q_raw %>%
select(spend_time:cram_subject)%>%
filter(!str_detect(school,"大學"))%>%
mutate(id=row_number())%>%
relocate(id)%>%
mutate(app=if_else(app=="其他",app_other,app),
act_source=if_else(act_source=="其他",act_source_other,act_source),
willingness=if_else(willingness=="其他",willingness_other,willingness)
)%>%
select(-c(app_other,act_source_other,willingness_other,grade_other))
View(clean_df)
View(q_raw)
clean_df %>%
mutate(annoyed_group=if_else(c("很多困擾","有點困擾") %in% annoy_overral,"困擾者","不困擾者"))%>% view
clean_df %>%
mutate(annoyed_group=if_else(annoy_overral=="很多困擾"|annoy_overral=="有點困擾","困擾者","不困擾者"))%>% view
clean_df %>%
mutate(annoyed_group=if_else(annoy_overral=="很多困擾"|annoy_overral=="有點困擾","困擾者","不困擾者"))%>%
select(annoyed_group,course_n:last(.))%>%view
clean_df %>%
mutate(annoyed_group=if_else(annoy_overral=="很多困擾"|annoy_overral=="有點困擾","困擾者","不困擾者"))%>%
select(annoyed_group,course_n:last())%>%view
clean_df %>%
mutate(annoyed_group=if_else(annoy_overral=="很多困擾"|annoy_overral=="有點困擾","困擾者","不困擾者"))%>%
select(annoyed_group,course_n:last)%>%view
clean_df %>%
mutate(annoyed_group=if_else(annoy_overral=="很多困擾"|annoy_overral=="有點困擾","困擾者","不困擾者"))%>%
select(annoyed_group,course_n:cram_subject)%>%view
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(readr)
library(stringr)
url<-"https://raw.githubusercontent.com/Xuans1211/108coursenews/main/data/questionaire.csv"
q_raw<-read_csv(url)
q_raw<-read_csv(url)
url<-"https://raw.githubusercontent.com/Xuans1211/108coursenews/main/data/questionaire.csv"
q_raw<-read_csv(url)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(readr)
library(stringr)
url<-"https://raw.githubusercontent.com/Xuans1211/108coursenews/main/data/questionaire.csv"
q_raw<-read_csv(url)
q_raw<-read_csv(url)
q_raw<-read_csv(url)
q_raw<-read_csv("data/questionaire.csv")
#rename
names(q_raw) <- c("spend_time","n_learning","n_performance","app","app_other","freq_teacher","freq_student","freq_parent","freq_cram","help_teacher","help_student","help_parent","help_cram","heard_agency","use_agency","agg_overral","agg_feature","agg_quality","agg_outoftest","agg_future","agg_description","edge_course","edge_act","edge_future","edge_art","edge_outoftest","annoy_overral","annoy_time","annoy_orientation","annoy_lackoftime","annoy_docsize","annoy_description","attitude_before","attitude_now","attitude_description","focus_self","focus_professor","course_n","course_type","act_type","act","act_source","act_source_other","willingness","willingness_other","school","school_type","grade","grade_other","gender","cram_school","cram_spend","cram_subject","email","55","56","57","58","59","60","61","62","63")
#這段是改欄位名
clean_df <-q_raw %>%
select(spend_time:cram_subject)%>%
filter(!str_detect(school,"大學"))%>%
mutate(id=row_number())%>%
relocate(id)%>%
mutate(app=if_else(app=="其他",app_other,app),
act_source=if_else(act_source=="其他",act_source_other,act_source),
willingness=if_else(willingness=="其他",willingness_other,willingness)
)%>%
select(-c(app_other,act_source_other,willingness_other,grade_other))
d3<-clean_df %>%
mutate(annoyed_group=if_else(annoy_overral=="很多困擾"|annoy_overral=="有點困擾","困擾者","不困擾者"),
attitude_group=if_else(attitude_now=="非常排斥"|attitude_now=="排斥","排斥者",if_else(attitude_now=="中立","中立者","支持者")))%>%
select(annoyed_group,attitude_group,course_n:cram_subject)%>%
mutate(course_n=str_sub(course_n,1,1)%>%as.numeric())%>%
group_by(attitude_group)%>%
summarise(avg_cn=mean(course_n))%>%
ungroup()%>%
ggplot()+aes(x=attitude_group,y=avg_cn,fill=attitude_group)+geom_col()+ylim(c(0,4))
d3
act_df<-clean_df %>%
select(id,act_type,grade)%>%
filter(!str_detect(act_type,"無參與"))%>%
mutate(技藝補習=str_detect(act_type,"技藝補習"),
考證照=str_detect(act_type,"考證照"),
參加社團=str_detect(act_type,"參加社團"),
參加競賽=str_detect(act_type,"參加競賽"),
`參加營隊、校外工作坊`=str_detect(act_type,"參加營隊、校外工作坊"),其他=str_detect(act_type,"其他"))%>%
gather(act_type,n,技藝補習,考證照,參加競賽,參加社團,`參加營隊、校外工作坊`,其他)%>%
filter(act_type!="其他")%>%
group_by(grade,act_type)%>%
summarise(total_n=sum(n))%>%
mutate(per_n=total_n/sum(total_n))%>%
ggplot()+aes(x=reorder(act_type,-per_n),y=per_n,fill=grade)+
geom_col(position=position_dodge())
act_df
act_df<-clean_df %>%
select(id,act_type,grade)%>%
filter(!str_detect(act_type,"無參與"))%>%
mutate(技藝補習=str_detect(act_type,"技藝補習"),
考證照=str_detect(act_type,"考證照"),
參加社團=str_detect(act_type,"參加社團"),
參加競賽=str_detect(act_type,"參加競賽"),
`參加營隊、校外工作坊`=str_detect(act_type,"參加營隊、校外工作坊"),其他=str_detect(act_type,"其他"))%>%
gather(act_type,n,技藝補習,考證照,參加競賽,參加社團,`參加營隊、校外工作坊`,其他)%>%
filter(act_type!="其他")%>%
group_by(grade,act_type)%>%
summarise(total_n=sum(n))%>%
mutate(per_n=total_n/sum(total_n))%>%
ggplot()+aes(x=reorder(grade,-per_n),y=per_n,fill=act_type)+
geom_col(position=position_dodge())
act_df
act_df<-clean_df %>%
select(id,act_type,grade)%>%
filter(!str_detect(act_type,"無參與"))%>%
mutate(技藝補習=str_detect(act_type,"技藝補習"),
考證照=str_detect(act_type,"考證照"),
參加社團=str_detect(act_type,"參加社團"),
參加競賽=str_detect(act_type,"參加競賽"),
`參加營隊、校外工作坊`=str_detect(act_type,"參加營隊、校外工作坊"),其他=str_detect(act_type,"其他"))%>%
gather(act_type,n,技藝補習,考證照,參加競賽,參加社團,`參加營隊、校外工作坊`,其他)%>%
filter(act_type!="其他")%>%
group_by(grade,act_type)%>%
summarise(total_n=sum(n))%>%
mutate(per_n=total_n/sum(total_n))%>%
ggplot()+aes(x=grade,y=per_n,fill=act_type)+
geom_col(position=position_dodge())
act_df
temp_df<-clean_df %>%
mutate(annoyed_group=if_else(annoy_overral=="很多困擾"|annoy_overral=="有點困擾","困擾者","不困擾者"),
attitude_group=if_else(attitude_now=="非常排斥"|attitude_now=="排斥","排斥者",if_else(attitude_now=="中立","中立者","支持者")))
temp<-temp_df
temp$attitude_now<-recode_factor(temp$attitude_now,"非常排斥"=1,"排斥"=2,"中立"=3,"支持"=4,"非常支持"=5)%>%as.numeric()
temp$attitude_before<-recode_factor(temp$attitude_before,"非常排斥"=1,"排斥"=2,"中立"=3,"支持"=4,"非常支持"=5)%>%as.numeric()
temp%>%
recode_factor(temp$edge_act%>%as.vector(),"非常不同意"=1,"不同意"=2,"普通"=3,"同意"=4,"非常同意"=5)%>%as.numeric()%>%view
temp$edge_act%>%
recode_factor(temp$edge_act%>%as.vector(),"非常不同意"=1,"不同意"=2,"普通"=3,"同意"=4,"非常同意"=5)%>%as.numeric()%>%view
temp$edge_act%>%
recode_character(edge_act,"非常不同意"=1,"不同意"=2,"普通"=3,"同意"=4,"非常同意"=5)%>%as.numeric()%>%view
temp$edge_act%>%
recode.character(,"非常不同意"=1,"不同意"=2,"普通"=3,"同意"=4,"非常同意"=5)%>%as.numeric()%>%view
temp$edge_act%>%
recode_factor(temp$edge_act%>%as.vector(),"非常不同意"=1,"不同意"=2,"普通"=3,"同意"=4,"非常同意"=5)%>%as.numeric()%>%view
temp$edge_act<-
recode_factor(temp$edge_act%>%as.vector(),"非常不同意"=1,"不同意"=2,"普通"=3,"同意"=4,"非常同意"=5)%>%as.numeric()%>%view
View(temp_df)
View(temp)
temp<-temp_df
temp$attitude_now<-recode_factor(temp$attitude_now,"非常排斥"=1,"排斥"=2,"中立"=3,"支持"=4,"非常支持"=5)%>%as.numeric()
temp$attitude_before<-recode_factor(temp$attitude_before,"非常排斥"=1,"排斥"=2,"中立"=3,"支持"=4,"非常支持"=5)%>%as.numeric()
temp$edge_act<-
recode_factor(temp$edge_act%>%as.vector(),"非常不同意"=1,"不同意"=2,"普通"=3,"同意"=4,"非常同意"=5)%>%as.numeric()
temp%>%mutate(change_type=if_else((attitude_now - attitude_before)>0,"enhanced",if_else((attitude_now - attitude_before)==0,"kept","decreased")))%>%
mutate(act_n=str_count(act_type,pattern="\n")+1)%>%
filter(change_type=="enhanced")%>%view
temp%>%mutate(change_type=if_else((attitude_now - attitude_before)>0,"enhanced",if_else((attitude_now - attitude_before)==0,"kept","decreased")))%>%
mutate(act_n=str_count(act_type,pattern="\n")+1)%>%
filter(change_type=="enhanced")%>%
group_by(change_type)%>%
mutate(技藝補習=str_detect(act_type,"技藝補習"),考證照=str_detect(act_type,"考證照"),
參加社團=str_detect(act_type,"參加社團"),
參加競賽=str_detect(act_type,"參加競賽"),
`參加營隊、校外工作坊`=str_detect(act_type,"參加營隊、校外工作坊"),其他=str_detect(act_type,"其他"))%>%
gather(act_type,n,技藝補習,考證照,參加競賽,參加社團,`參加營隊、校外工作坊`,其他)%>%
ungroup()%>%
filter(act_type!="其他")%>%
group_by(act_type,change_type)%>%
summarise(total_n=sum(n))%>%
mutate(per_n=total_n/sum(total_n))%>%
ungroup()%>%
ggplot()+aes(x=change_type,y=per_n,fill=act_type)+geom_col(
# position = position_dodge()
)
temp%>%mutate(change_type=if_else((attitude_now - attitude_before)>0,"enhanced",if_else((attitude_now - attitude_before)==0,"kept","decreased")))%>%
mutate(act_n=str_count(act_type,pattern="\n")+1)%>%
# filter(change_type=="enhanced")%>%
group_by(change_type)%>%
mutate(技藝補習=str_detect(act_type,"技藝補習"),考證照=str_detect(act_type,"考證照"),
參加社團=str_detect(act_type,"參加社團"),
參加競賽=str_detect(act_type,"參加競賽"),
`參加營隊、校外工作坊`=str_detect(act_type,"參加營隊、校外工作坊"),其他=str_detect(act_type,"其他"))%>%
gather(act_type,n,技藝補習,考證照,參加競賽,參加社團,`參加營隊、校外工作坊`,其他)%>%
ungroup()%>%
filter(act_type!="其他")%>%
group_by(act_type,change_type)%>%
summarise(total_n=sum(n))%>%
mutate(per_n=total_n/sum(total_n))%>%
ungroup()%>%
ggplot()+aes(x=change_type,y=per_n,fill=act_type)+geom_col(
# position = position_dodge()
)
d3<-clean_df %>%
mutate(annoyed_group=if_else(annoy_overral=="很多困擾"|annoy_overral=="有點困擾","困擾者","不困擾者"),
attitude_group=if_else(attitude_now=="非常排斥"|attitude_now=="排斥","排斥者",if_else(attitude_now=="中立","中立者","支持者")))%>%
select(annoyed_group,attitude_group,course_n:cram_subject)%>%
mutate(course_n=str_sub(course_n,1,1)%>%as.numeric())%>%
group_by(attitude_group)%>%
summarise(avg_cn=mean(course_n))%>%
ungroup()%>%
ggplot()+aes(x=attitude_group,y=avg_cn,fill=attitude_group)+geom_col()+ylim(c(0,4))
d3
temp%>%mutate(change_type=if_else((attitude_now - attitude_before)>0,"enhanced",if_else((attitude_now - attitude_before)==0,"kept","decreased")))%>%
# filter(change_type=="enhanced")%>%
group_by(change_type)%>%
summarise(avg_ea=mean(edge_act))%>%view
temp$edge_course<-
recode_factor(temp$edge_act%>%as.vector(),"非常不同意"=1,"不同意"=2,"普通"=3,"同意"=4,"非常同意"=5)%>%as.numeric()
temp$edge_course<-
recode_factor(temp$edge_course%>%as.vector(),"非常不同意"=1,"不同意"=2,"普通"=3,"同意"=4,"非常同意"=5)%>%as.numeric()
temp<-temp_df
temp$attitude_now<-recode_factor(temp$attitude_now,"非常排斥"=1,"排斥"=2,"中立"=3,"支持"=4,"非常支持"=5)%>%as.numeric()
temp$attitude_before<-recode_factor(temp$attitude_before,"非常排斥"=1,"排斥"=2,"中立"=3,"支持"=4,"非常支持"=5)%>%as.numeric()
temp$edge_act<-
recode_factor(temp$edge_act%>%as.vector(),"非常不同意"=1,"不同意"=2,"普通"=3,"同意"=4,"非常同意"=5)%>%as.numeric()
temp$edge_course<-
recode_factor(temp$edge_course%>%as.vector(),"非常不同意"=1,"不同意"=2,"普通"=3,"同意"=4,"非常同意"=5)%>%as.numeric()
temp%>%mutate(change_type=if_else((attitude_now - attitude_before)>0,"enhanced",if_else((attitude_now - attitude_before)==0,"kept","decreased")))%>%
# filter(change_type=="enhanced")%>%
group_by(change_type)%>%
summarise(avg_ec=mean(edge_course))%>%view
temp$art<-
recode_factor(temp$art%>%as.vector(),"非常不同意"=1,"不同意"=2,"普通"=3,"同意"=4,"非常同意"=5)%>%as.numeric()
temp$edge_art<-
recode_factor(temp$edge_art%>%as.vector(),"非常不同意"=1,"不同意"=2,"普通"=3,"同意"=4,"非常同意"=5)%>%as.numeric()
temp%>%mutate(change_type=if_else((attitude_now - attitude_before)>0,"enhanced",if_else((attitude_now - attitude_before)==0,"kept","decreased")))%>%
# filter(change_type=="enhanced")%>%
group_by(change_type)%>%
summarise(avg_ear=mean(edge_art))%>%view
temp$edge_outoftest<-
recode_factor(temp$edge_outoftest%>%as.vector(),"非常不同意"=1,"不同意"=2,"普通"=3,"同意"=4,"非常同意"=5)%>%as.numeric()
temp%>%mutate(change_type=if_else((attitude_now - attitude_before)>0,"enhanced",if_else((attitude_now - attitude_before)==0,"kept","decreased")))%>%
# filter(change_type=="enhanced")%>%
group_by(change_type)%>%
summarise(avg_ear=mean(edge_outoftest))%>%view
temp$edge_future<-
recode_factor(temp$edge_future%>%as.vector(),"非常不同意"=1,"不同意"=2,"普通"=3,"同意"=4,"非常同意"=5)%>%as.numeric()
temp%>%mutate(change_type=if_else((attitude_now - attitude_before)>0,"enhanced",if_else((attitude_now - attitude_before)==0,"kept","decreased")))%>%
# filter(change_type=="enhanced")%>%
group_by(change_type)%>%
summarise(avg_ear=mean(edge_future))%>%view
temp%>%mutate(change_type=if_else((attitude_now - attitude_before)>0,"enhanced",if_else((attitude_now - attitude_before)==0,"kept","decreased")))%>%
mutate(act_n=str_count(act_type,pattern="\n")+1)%>%
# filter(change_type=="enhanced")%>%
group_by(change_type)%>%
mutate(技藝補習=str_detect(act_type,"技藝補習"),考證照=str_detect(act_type,"考證照"),
參加社團=str_detect(act_type,"參加社團"),
參加競賽=str_detect(act_type,"參加競賽"),
`參加營隊、校外工作坊`=str_detect(act_type,"參加營隊、校外工作坊"),其他=str_detect(act_type,"其他"))%>%
gather(act_type,n,技藝補習,考證照,參加競賽,參加社團,`參加營隊、校外工作坊`,其他)%>%
ungroup()%>%View
temp%>%mutate(change_type=if_else((attitude_now - attitude_before)>0,"enhanced",if_else((attitude_now - attitude_before)==0,"kept","decreased")))%>%
mutate(act_n=str_count(act_type,pattern="\n")+1)%>%
# filter(change_type=="enhanced")%>%
group_by(change_type)%>%
mutate(技藝補習=str_detect(act_type,"技藝補習"),考證照=str_detect(act_type,"考證照"),
參加社團=str_detect(act_type,"參加社團"),
參加競賽=str_detect(act_type,"參加競賽"),
`參加營隊、校外工作坊`=str_detect(act_type,"參加營隊、校外工作坊"),其他=str_detect(act_type,"其他"))%>% View
temp%>%mutate(change_type=if_else((attitude_now - attitude_before)>0,"enhanced",if_else((attitude_now - attitude_before)==0,"kept","decreased")))%>%
mutate(act_n=str_count(act_type,pattern="\n")+1)%>%
# filter(change_type=="enhanced")%>%
group_by(change_type)%>%
mutate(技藝補習=str_detect(act_type,"技藝補習"),考證照=str_detect(act_type,"考證照"),
參加社團=str_detect(act_type,"參加社團"),
參加競賽=str_detect(act_type,"參加競賽"),
`參加營隊、校外工作坊`=str_detect(act_type,"參加營隊、校外工作坊"),其他=str_detect(act_type,"其他"))%>%
gather(act_type,n,技藝補習,考證照,參加競賽,參加社團,`參加營隊、校外工作坊`,其他)%>% View
