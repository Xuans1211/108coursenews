knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(readr)
url<-"https://github.com/Xuans1211/108coursenews/blob/main/data/questionaire.csv"
q_raw<-read_csv(url)
View(q_raw)
q_raw<-read_csv(url)
View(q_raw)
?read_csv
library(showtext)
library(tidyverse)
.libPaths("C:\Program Files\R\R-4.1.3")
.libPaths("C:\\Program Files\\R\\R-4.1.3")
library(showtext)
library(showtext)
library(tidyverse)
library(showtext)
library(tidyverse)
P0<-df_2019 %>%
ggplot(aes(x=income,y=perc,fill=income))+
geom_bar(stat = "identity",width = 0.7)+
geom_text(aes(label=percentage),hjust=1.2,size=5)+
coord_flip()+
labs(title="標題放這裡",
caption= "資料來源放這裡",x=NULL,y=NULL)+
theme(
legend.position = "none",
plot.title= element_text(hjust=0.5,face="bold"),
plot.caption = element_text(hjust=0.5,face="bold"),
panel.grid.major = element_blank(),
panel.background = element_blank(),
axis.text.y = element_text(hjust = 1.4,margin=margin(r=0,l=0),size=10),
axis.title.y = element_text(angle=0),
axis.ticks = element_blank(),
axis.text.x = element_blank(),
aspect.ratio = 1.5/2.5,
panel.border = element_rect(colour = "black", fill=NA, size=1)
)+scale_fill_manual(values=c("#E0E0E0","#E0E0E0","#E0E0E0","#E0E0E0","#E0E0E0","#FFE66F"))
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(readr)
library(stringr)
url<-"https://raw.githubusercontent.com/Xuans1211/108coursenews/main/data/questionaire.csv"
url<-"https://raw.githubusercontent.com/Xuans1211/108coursenews/main/data/questionaire.csv"
q_raw<-read_csv(url)
#rename
colnames<-read.csv("colnames.csv")
colnames(q_raw)<-colnames$name
clean_df <-q_raw %>%
select(spend_time:cram_subject)%>%
filter(!str_detect(school,"大學"))%>%
mutate(id=row_number())%>%
relocate(id)%>%
mutate(app=if_else(app=="其他",app_other,app),
act_source=if_else(act_source=="其他",act_source_other,act_source),
willingness=if_else(willingness=="其他",willingness_other,willingness)
)%>%
select(-c(app_other,act_source_other,willingness_other,grade_other))
act_df<-clean_df %>%
select(id,act_type,grade)%>%
filter(!str_detect(act_type,"無參與"))%>%
mutate(技藝補習=str_detect(act_type,"技藝補習"),
考證照=str_detect(act_type,"考證照"),
參加社團=str_detect(act_type,"參加社團"),
參加競賽=str_detect(act_type,"參加競賽"),
`參加營隊、校外工作坊`=str_detect(act_type,"參加營隊、校外工作坊"),其他=str_detect(act_type,"其他"))%>%
gather(act_type,n,技藝補習,考證照,參加競賽,參加社團,`參加營隊、校外工作坊`,其他)%>%
group_by(grade,act_type)%>%
summarise(total_n=sum(n))%>%
ggplot()+aes(x=reorder(act_type,-total_n),y=total_n,fill=grade)+
geom_col(position=position_dodge())
act_df
clean_df %>%
select(id,act_type,cram_school,cram_spend)%>%
mutate(act_n=str_count(act_type,pattern="\n")+1)%>%
mutate(考證照=str_detect(act_type,"考證照"),
參加社團=str_detect(act_type,"參加社團"),
參加競賽=str_detect(act_type,"參加競賽"),
`參加營隊、校外工作坊`=str_detect(act_type,"參加營隊、校外工作坊"),其他=str_detect(act_type,"其他"))%>%
gather(act_type,n,考證照,參加競賽,參加社團,`參加營隊、校外工作坊`,其他)%>% view
p1<-colnames$name
saveRDs(p1,"p2")
saveRDs(p1,"p2.rds")
saveRDs(p1,"p2.RDS")
saveRDS(p1,"p2.RDS")
url<-"https://raw.githubusercontent.com/Xuans1211/108coursenews/main/data/questionaire.csv"
q_raw<-read_csv(url)
p2 <- readRDS("D:/desktop/Graduate School/110-2/data_R/108coursenews/p2.RDS")
colnames(q_raw)<-p2
View(q_raw)
View(q_raw)
clean_df <-q_raw %>%
select(spend_time:cram_subject)%>%
filter(!str_detect(school,"大學"))%>%
mutate(id=row_number())%>%
relocate(id)%>%
mutate(app=if_else(app=="其他",app_other,app),
act_source=if_else(act_source=="其他",act_source_other,act_source),
willingness=if_else(willingness=="其他",willingness_other,willingness)
)%>%
select(-c(app_other,act_source_other,willingness_other,grade_other))
View(q_raw)
act_df<-clean_df %>%
select(id,act_type,grade)%>%
filter(!str_detect(act_type,"無參與"))%>%
mutate(技藝補習=str_detect(act_type,"技藝補習"),
考證照=str_detect(act_type,"考證照"),
參加社團=str_detect(act_type,"參加社團"),
參加競賽=str_detect(act_type,"參加競賽"),
`參加營隊、校外工作坊`=str_detect(act_type,"參加營隊、校外工作坊"),其他=str_detect(act_type,"其他"))%>%
gather(act_type,n,技藝補習,考證照,參加競賽,參加社團,`參加營隊、校外工作坊`,其他)%>%
group_by(grade,act_type)%>%
summarise(total_n=sum(n))%>%
ggplot()+aes(x=reorder(act_type,-total_n),y=total_n,fill=grade)+
geom_col(position=position_dodge())
act_df
clean_df %>%
select(id,act_type,cram_school,cram_spend)%>%
mutate(act_n=str_count(act_type,pattern="\n")+1)%>%
mutate(考證照=str_detect(act_type,"考證照"),
參加社團=str_detect(act_type,"參加社團"),
參加競賽=str_detect(act_type,"參加競賽"),
`參加營隊、校外工作坊`=str_detect(act_type,"參加營隊、校外工作坊"),其他=str_detect(act_type,"其他"))%>%
gather(act_type,n,考證照,參加競賽,參加社團,`參加營隊、校外工作坊`,其他)%>% view
clean_df %>%
count(annoy_overral)%>% view
clean_df%>%
count(attitude_now)%>%view
clean_df%>%
group_by(grade)
clean_df%>%
group_by(grade)%>%
count(attitude_now)%>%view
clean_df%>%
count(attitude_now)%>%
clean_df <-q_raw %>%
select(spend_time:cram_subject)%>%
filter(!str_detect(school,"大學"))%>%
mutate(id=row_number())%>%
relocate(id)%>%
mutate(app=if_else(app=="其他",app_other,app),
act_source=if_else(act_source=="其他",act_source_other,act_source),
willingness=if_else(willingness=="其他",willingness_other,willingness)
)%>%
select(-c(app_other,act_source_other,willingness_other,grade_other))
clean_df%>%
count(attitude_now)
clean_df%>%
count(attitude_now)%>% view
